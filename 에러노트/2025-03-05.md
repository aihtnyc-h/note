### **에러노트: 숫자 데이터 처리 문제**

---

#### **문제 설명:**

기존에 데이터를 **숫자**로 취급하려는 시도에서, 숫자 앞에 0이 올 경우 **문자로 처리**되는 문제가 발생했습니다. 이를 해결하려는 시도에서 `=` 문자를 추가하여 값을 수정하려 했으나, 숫자가 아닌 문자로 인식되는 문제로 인해 에러가 발생하였습니다.

#### **변경 전:**

```js
rowData.push(`'${cellText}'`);
```

- **목표**: 숫자 앞에 0이 올 경우에도 숫자로 인식하려는 시도였습니다. 하지만, 이 방식은 **모든 값**을 문자로 처리하는 문제를 야기할 수 있습니다.

#### **변경 후:**


```js
rowData.push(`="${cellText}"`);
```


- **목표**: Excel에서 숫자 앞에 있는 0을 포함시키기 위해 `=`를 추가하여 숫자를 문자로 처리되지 않도록 시도했지만, 여전히 **숫자**가 아닌 **문자**로 인식되고 있습니다. 이 방법은 Excel에서 공식처럼 처리될 수 있으나, 숫자로 제대로 인식되지 않는 경우가 발생할 수 있습니다.

---

#### **문제 발생 원인:**

1. **`=` 문자를 사용하여 셀에 데이터를 삽입**:
    
    - Excel에서 `=`로 시작하는 셀은 **수식**으로 취급될 수 있습니다. 하지만 이 방법은 숫자값을 처리하는 데 있어서 **예상치 못한 결과**를 발생시킬 수 있습니다.
2. **숫자와 문자 처리 방식의 혼동**:
    
    - `cellText`가 숫자형일 때, `cellText.toString()`을 사용하여 **문자열로 변환**하려고 했지만, 이 과정에서 **숫자 앞의 0**을 유지하지 못하고 문자로 인식하게 되는 경우가 발생합니다.
    - Excel에서 **숫자 앞의 0**을 그대로 처리하려면 **문자열**로 데이터를 처리해야 하므로, 이 부분에 대한 조정이 필요합니다.
3. **Excel에서의 수식 처리**:
    
    - `="..."` 형식으로 작성된 값은 Excel에서 **문자열**로 처리되기는 하지만, 의도치 않게 **수식으로 해석**될 수 있습니다. 이로 인해 Excel에서 "0"을 포함한 숫자 값이 **올바르게 처리되지 않거나 의도대로 표시되지 않을 수 있습니다.**

---

#### **해결 방안:**

1. **숫자 앞 0을 포함한 데이터를 문자열로 처리**:
    
    - **숫자 앞의 0을 유지**하려면, 데이터를 **문자열**로 취급하고, Excel에서 해당 데이터를 **텍스트로 인식**할 수 있도록 처리해야 합니다.
    
    **수정 방법:**
    
    - `="0${cellText}"`와 같이 문자열로 변환하여 **Excel에서 수식**이 아닌 **텍스트**로 취급되도록 합니다.
    - Excel에 **숫자 데이터를 텍스트로 저장**할 때, `=` 없이도 Excel에서 **텍스트 형식으로 자동 인식**되도록 할 수 있습니다.
2. **셀 데이터를 문자열로 처리**:
    
    - `cellText`가 숫자일 경우, 앞의 `0`을 보존하려면 반드시 **문자열**로 처리하는 방법이 필요합니다.
    - **Excel에서 숫자 앞 0을 포함한 문자열을 처리**하려면, 해당 셀에 대해 **' (작은 따옴표)**를 사용하여 텍스트로 인식시키는 방법도 있습니다.
    

```js
rowData.push(`="'${cellText}'"`);  // 앞의 0을 포함한 숫자를 텍스트로 처리
```
    
    
3. **CSV 형식에서 숫자와 텍스트 구분**:
    
    - CSV 형식에서 **숫자**와 **문자**를 구분할 때, Excel에서 **숫자 앞의 0을 유지**하려면 해당 값에 `"`를 추가하여 **문자열**로 인식시킬 수 있습니다. 예를 들어:
    

```js
rowData.push(`="${cellText}"`);
```

    
    - 그러나 이 경우에도 Excel이 이를 **문자열로 처리**하도록 설정해야 합니다.

---

#### **최종 해결 방법:**

```js
// 테이블 본문에서 각 행의 데이터 가져오기   
data.each(function(row, rowIndex) {       
	let rowData = [];       
	row.forEach(function(cell, columnIndex) {           
		let cellText = cell.toString().trim();              
		if (columnIndex === 3) {               // 숫자 앞 0을 포함해 문자열로 처리 
			rowData.push(`="'${cellText}'"`);           
		} else {               // 나머지 열 처리 (컴마(,) 제거 및 따옴표 추가) 
			rowData.push(`"${cellText.replace(/,/g, "")}"`);           
	}       
	});       
csv.push(rowData.join(","));   });
```

- **숫자 앞 0을 유지**하려면 `="'${cellText}'"`로 처리하여 Excel에서 **문자열**로 처리되도록 합니다.

---

#### **결론:**

- **숫자 데이터 앞에 0을 유지하려면 해당 데이터를 문자열로 취급**해야 하며, Excel에서 이를 **텍스트로 인식**하도록 적절한 포맷을 설정해야 합니다.
- `=`를 사용하여 수식을 시작하는 것은 **예기치 않은 문제**를 일으킬 수 있기 때문에, 이를 텍스트로 변환하는 방식으로 수정하는 것이 좋습니다.