원인 : html 을 반환하지 않고, 결과만 받아야하는 상황에 아래와 같은 에러 발생!

[THYMELEAF][http-nio-9090-exec-1] Exception processing template "alimTalk/countAlimCenter": Error resolving template [alimTalk/countAlimCenter], template might not exist or might not be accessible by any of the configured Template Resolvers

`@ResponseBody`
사용!!


HTML을 사용하지 않고 JSON만 반환하는 컨트롤러라면, `Thymeleaf` 템플릿 처리와 관련된 에러는 불필요할 수 있습니다. 이런 경우 `@ResponseBody` 어노테이션을 사용하여 JSON 응답을 명시적으로 반환하도록 설정해야 합니다.


-----------------------------------
```
        StringBuilder textBuilder = new StringBuilder();  
        StringBuilder finalMessageBuilder = new StringBuilder();  
  
        try {  
            String tpl_code = "TU_4096";                                       // (템플릿 마다 코드가 다름)  
            String subject_1 = "알림 집계 현황";                                 // (템플릿 마다 제목이 다름)  
            String testMode = "Y";                                            // 테스트 모드 시 Y (테스트 모드가 아닐 경우 주석 or N으로 설정)  
            String dayPart ="";  
            long totalErrorCount = 0;  
            long totalPrErrorCount = 0;  
            String totalError = "";  
            // 현재 시간 확인  
            LocalTime now = LocalTime.now();  
            List<Map<String, Object>> selectlist;  
  
            // 시간 구간에 따른 쿼리 분기 처리 + 스케줄러 여유 시간 추가(30분)  
            if (now.isAfter(LocalTime.of(18, 30)) || now.isBefore(LocalTime.of(7, 30))) {  
                // 1구간: 18시 ~ 07시  
                selectlist = alimTalkMapper.selectErrorForTimeRange1();  // 여기에 해당 시간 구간의 쿼리를 작성  
                dayPart = "야간";  
            } else if (now.isAfter(LocalTime.of(7, 30)) && now.isBefore(LocalTime.of(12, 30))) {  
                // 2구간: 07시 ~ 12시  
                selectlist = alimTalkMapper.selectErrorForTimeRange2();  // 여기에 해당 시간 구간의 쿼리를 작성  
                dayPart = "오전";  
            } else {  
                // 3구간: 12시 ~ 18시  
                selectlist = alimTalkMapper.selectErrorForTimeRange3();  // 여기에 해당 시간 구간의 쿼리를 작성  
                dayPart = "오후";  
            }  
            // selectError 메서드가 반환하는 리스트가 각 충전소의 정보를 포함하고 있다고 가정  
//            List<Map<String, Object>> selectlist = alimTalkMapper.selectError();  // 각 충전소의 에러 정보를 포함하는 Map 리스트  
            // 회사별 메시지를 저장할 Map 생성  
            Map<String, StringBuilder> companyMessages = new HashMap<>();  
            Set<String> corpNames = new HashSet<>();  
            for (Map<String, Object> messageMap : selectlist) {  
                String corpName = messageMap.get("corpName").toString();  
                corpNames.add(corpName);  
                // 고객사별 메시지 초기화  
                companyMessages.putIfAbsent(corpName, new StringBuilder());  
            }  
  
            for (Map<String, Object> errorInfo : selectlist) {  
                String startDate = errorInfo.get("startDate").toString();  
                String endDate = errorInfo.get("endDate").toString();  
                String corpName = errorInfo.get("corpName").toString();  
                String stationName = errorInfo.get("stationName").toString();  
                Integer dayErrorCount = ((BigInteger) errorInfo.get("errorCount")).intValue();  
                // 전일 에러 발생 건수  
                Integer prevErrorCount = ((BigInteger) errorInfo.get("prevErrorCount")).intValue();  
                Integer errorChangeCount;  
  
                // 금일 - 전일  
  
                errorChangeCount = dayErrorCount - prevErrorCount;  
  
                String errorCount;  
                if (errorChangeCount > 0) {  
                    errorCount = dayErrorCount + " (▲ " + errorChangeCount + "건)";  
                } else if (errorChangeCount < 0) {  
                    errorCount = dayErrorCount + " (▼ " + errorChangeCount + "건)";  
                } else {  
                    errorCount = dayErrorCount + "건";  
                }  
                // totalErrorCount  
                totalErrorCount += dayErrorCount;  
                totalPrErrorCount += errorChangeCount;  
                String totalPreErrorCount = "";  
                //  
                if (totalPrErrorCount > 0) {  
                    totalPreErrorCount = " (▲ " + totalPrErrorCount + "건)";  
                } else {  
                    totalPreErrorCount = dayErrorCount + " (▼ " + totalPrErrorCount + "건)";  
                }  
  
                totalError = totalErrorCount+"건("+totalPreErrorCount+")";  
  
  
                // 고객사별 메시지에 충전소별 에러 정보 추가  
                textBuilder = companyMessages.get(corpName);  
                textBuilder.append("충전소명 : ").append(stationName).append("\n")  
                        .append("에러발생 건수 : ").append(errorCount).append("\n\n");  
            }  
//            System.out.println("///final fullMessage : " + fullMessage);  
  
            // 각 고객사별로 메시지 전송  
            List<String> messages = new ArrayList<>(); // 메시지를 저장할 리스트  
            for (String company : corpNames) {  
                finalMessageBuilder = new StringBuilder();  
                finalMessageBuilder.append("[모던텍 - 알림센터]\n")  
                        .append("\n")  
                        .append("충전소별 "+ dayPart +" 알림 집계 현황\n")  
                        .append("\n")  
                        .append("발생기간 : \n")  
                        .append(selectlist.get(0).get("startDate")).append(" ~ \n")  
                        .append(selectlist.get(0).get("endDate")).append("\n")  
                        .append("\n")  
                        .append("고객사 : ").append(company).append("\n")  
                        .append("\n")  
                        .append("총 발생 건수 : " + totalError)  
                        .append("\n")  
                        .append(companyMessages.get(company)); // 고객사별 메시지 추가  
  
                messages.add(finalMessageBuilder.toString()); // 메시지를 리스트에 추가  
            }  
            // 최종 메시지 출력  
            for (int i = 0; i < messages.size(); i++) {  
                String messageName = "message_" + (i + 1);  
                System.out.println(messageName + ": " + messages.get(i)); // 각 메시지를 출력  
            }  
            int receiverIndex = 1;  
            for (String receiver : receiverList) {  
                int corpIndex = 1;  
                for (String company : corpNames) {  
                    // 알림톡으로 보낼 정보를 parameters에 넣는다.  
                    MultiValueMap<String, String> parameters = new LinkedMultiValueMap<>();  
                    parameters.add("apikey", apikey);  
                    parameters.add("userid", userid);  
                    parameters.add("senderkey", senderkey);  
                    parameters.add("tpl_code", tpl_code);  
                    parameters.add("sender", sender);  
                    parameters.add("receiver_" + receiverIndex, receiver);  
                    parameters.add("subject", subject_1);  
  
                    // 각 메시지를 순서대로 parameters에 추가  
                    if (corpIndex <= messages.size()) { // 조건을 <=로 수정  
                        parameters.add("message_1", messages.get(corpIndex - 1)); // index - 1로 접근  
                    }  
//                        System.out.println("////corpIndex : " + corpIndex);  
                    parameters.add("testMode", testMode);  
//                System.out.println("///parameters : "+parameters);  
                    // RestTemplate을 사용하여 알림톡 발송  
                    // RestTemplate 객체 생성  
                    RestTemplate restTemplate = new RestTemplate();  
  
                    // HTTP 요청 헤더 생성  
                    HttpHeaders httpHeaders = new HttpHeaders();  
  
                    // Content-Type 헤더를 application/x-www-form-urlencoded로 설정  
                    httpHeaders.setContentType(MediaType.APPLICATION_FORM_URLENCODED);  
  
                    // HTTP 요청 본문과 헤더를 포함하는 HttpEntity 생성  
                    HttpEntity httpEntity = new HttpEntity<>(parameters, httpHeaders);  
  
                    // RestTemplate을 사용하여 HTTP POST 요청을 보내고, 응답을 받음  
                    ResponseEntity<String> responseEntity = restTemplate.exchange(apiURL, HttpMethod.POST, httpEntity, String.class);  
  
                    // 응답이 성공적으로 받아지면 처리  
                    if (responseEntity.getStatusCode() == HttpStatus.OK) {  
                        AlimTalkDTO.AlimTalkResponse am = new AlimTalkDTO.AlimTalkResponse();  
                        JsonElement jsonElement = JsonParser.parseString(responseEntity.getBody());  
                        String resultCode = jsonElement.getAsJsonObject().get("code").getAsString(); // "code" 필드 : 응답 코드  
                        String resultMsg = jsonElement.getAsJsonObject().get("message").getAsString(); // "message 필드 : 응답 메시지  
  
                        switch (resultCode) {  
                            case "0":  
                                // 성공한 경우에는 "info" 필드를 추출하여 처리  
                                am.setCode(0);  
                                am.setMessage(resultMsg);  
                                // 응답에서 'info' 필드 추출하여 AlimTalkModel에 설정  
                                JsonObject infoObject = jsonElement.getAsJsonObject().get("info").getAsJsonObject();  
  
                                // "info" 필드의 하위 필드들을 추출하여 AlimTalkModel에 설정  
                                am.setType(infoObject.get("type").getAsString());  
                                am.setCurrent(infoObject.get("current").getAsString());  
                                am.setUnit(infoObject.get("unit").getAsInt());  
                                am.setTotal(infoObject.get("total").getAsInt());  
  
                                // test모드에서는 비활성화  
//                                am.setMid(infoObject.get("mid").getAsString());  
//                                am.setScnt(infoObject.get("scnt").getAsInt());  
//                                am.setFcnt(infoObject.get("fcnt").getAsInt());  
  
                                // 알림톡 내용 DB 적재  
                                am.setSuccessAlimTalk("1");  
                                am.setTrnsmDtls("모던텍 집계현황 알림톡 전송 성공");  
                                am.setCreatedAt(LocalDateTime.now());  
                                System.out.println(am);  
                                // 성공 사유 DB 적재  
                                alimTalkMapper.registerAlimTalk(am);  
                                // 결과 JSON 객체 설정  
                                obj.put("success", true);  
                                obj.put("message", resultMsg);  
                                obj.put("result", result);  
                                break;  
  
                            default: // 실패한 경우  
                                am.setCode(jsonElement.getAsJsonObject().get("code").getAsInt()); // 실패 시 "code" 필드 추출하여 설정  
                                am.setMessage(jsonElement.getAsJsonObject().get("message").getAsString()); // 실패 시 "message" 필드 추출하여 설정  
                                am.setSuccessAlimTalk("0");  
                                am.setTrnsmDtls("모던텍 집계현황 알림톡 전송 실패");  
                                am.setCreatedAt(LocalDateTime.now());  
                                am.setCurrent(null);  
                                System.out.println(am);  
                                // 실패 사유 DB 적재  
                                alimTalkMapper.registerAlimTalk(am);  
                                // 결과 JSON 객체 설정  
                                obj.put("success", false);  
                                obj.put("message", resultMsg);  
                                obj.put("result", result);  
                                break;  
                        }  
                    }  
                }  
            }
```