- 장애 대시보드 jpa 에서 mapper 로 변경 작업

----

```
2024-11-22 09:01:57.824 ERROR 35624 --- [nio-9090-exec-1] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is org.apache.ibatis.binding.BindingException: Invalid bound statement (not found): com.moderntec.mog.monitoring.disabilityHistory.mapper.DisabilityHistoryMapper.selectDisabilityStatus] with root cause

org.apache.ibatis.binding.BindingException: Invalid bound statement (not found): com.moderntec.mog.monitoring.disabilityHistory.mapper.DisabilityHistoryMapper.selectDisabilityStatus

```

**매퍼 네임스페이스 확인!!**
DisabilityHistoryMapper 이름을 바꾸지 않았다!!

----
resultType 매핑 실수
DisabilityHistoryDTO.DisabilityStatus
DB table에 존재하지 않는 컬럼을 사용하기 위해 dto 사용 
하지만 resultType에 아래와 같이 작성하였으나 에러!!
```
<select id="selectDisabilityStatus" resultType="com.moderntec.mog.monitoring.disabilityHistory.dto.DisabilityHistoryDTO.DisabilityStatus"> 
```

```
[org/mybatis/spring/boot/autoconfigure/MybatisAutoConfiguration.class]: Bean instantiation via factory method failed;
```

검색해서 찾아보니 dto 안에 있는 것을 사용하려면 $ 사용해야함!

```
<select id="selectDisabilityStatus" resultType="com.moderntec.mog.monitoring.disabilityHistory.dto.DisabilityHistoryDTO$DisabilityStatus">  
    /* DisabilityHistory.xml|selectDisabilityStatus| 장애 현황 조회 |pha */  
    SELECT  
           SUM(CASE WHEN e.ERROR_LEVEL = '심각' THEN 1 ELSE 0 END) AS serious  
         , SUM(CASE WHEN e.ERROR_LEVEL = '주의' THEN 1 ELSE 0 END) AS caution  
         , SUM(CASE WHEN e.ERROR_LEVEL = '경고' THEN 1 ELSE 0 END) AS warning  
         , COUNT(*) AS totalCount  
    FROM  
        tb_charger_error c  
            JOIN  
        tb_error_code e ON e.id = c.errorcode  
    WHERE  
        DATE_FORMAT(c.OCRN_DTTM, '%Y-%m-%d %H:%i:%s') BETWEEN #{startDate} AND #{endDate};  
</select>

```


----

```
 Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is org.apache.ibatis.binding.BindingException: Mapper method 'com.moderntec.mog.common.mapper.CommonUserMapper.countByAccountLocked attempted to return null from a method with a primitive return type (int).] with root cause
```

jpa 에서 mapper로 변경하는 과정에서 값이 null이기 때문에 발생한 문제!!